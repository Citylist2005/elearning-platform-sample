<!doctype html>
<html><head>
  <meta charset="utf-8">
  <title>Course</title>
  <link rel="stylesheet" href="/styles.css">
</head><body>
  <div id="content"></div>
  <a href="/courses.html">Back to Courses</a>
  <script>
    async function load(){
      const params = new URLSearchParams(location.search);
      const id = params.get('id');
      if (!id) { document.getElementById('content').textContent = 'No course id provided'; return;}
      const res = await fetch('/api/courses/' + encodeURIComponent(id));
      if (!res.ok){ document.getElementById('content').textContent = 'Course not found'; return;}
      const course = await res.json();
      document.getElementById('content').innerHTML = `<h2>${course.title}</h2>
        <p>${course.description}</p><p>Seats: <span id="seats">${course.seats}</span></p>
        <button id="enroll">Enroll</button>
        <button id="startQuiz">Start Quiz</button>
        <div id="msg"></div>`;
      document.getElementById('enroll').addEventListener('click', async ()=>{
        const r = await fetch('/api/courses/' + encodeURIComponent(id) + '/enroll', { method:'POST' });
        const j = await r.json();
        document.getElementById('msg').textContent = j.error || j.message;
        if (r.ok) {
          const seatsEl = document.getElementById('seats');
          seatsEl.textContent = Number(seatsEl.textContent) - 1;
        }
      });
      document.getElementById('startQuiz').addEventListener('click', ()=>{
        location.href = '/quiz.html?id=' + encodeURIComponent(id);
      });
    }
    load();
  </script>
</body></html>
